getPath = function (n) {
    p = n.name;
    while (n.parent) {
        p = getPath(db.files.findOne({_id:n.parent}));
    }
}

m = function() {
  emit(this.digest, 1);
}

r = function(k, v) {
  return Array.sum(v);
}

db.mp3.mapReduce(m, r, {out: "mp3_dups"}, {sort: {digest: 1}});

getPath(
    db.files.findOne(
	{_id: db.mp3.findOne(
	    {digest: db.duplicates.findOne(
		{value: {$gt: 1}}
	    )._id}
	).file_id}
    )
)
